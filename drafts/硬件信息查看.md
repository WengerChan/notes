## CPU

```sh
cat /proc/cpuinfo
lscpu
sar -u 1 1
```

## 磁盘

```sh
lsblk
lsblk -d -n -o serial /dev/sda
smartctl -a /dev/sda
smartctl -i /dev/sda
hdparam -i /dev/sda
udevadm info --query=all --name=/dev/sda
cat /proc/scsi/scsi
lshw -class disk   #< capabilities: 15000rpm ... 15000rpm表示转数
lsscsi
lsscsi -t -L 
cat /proc/partition
sginfo -g /dev/sda  #< Rotational Rate: 转数
cat /sys/block/sda/queue/rotational  # 1 表示可以转 -> HDD
lsblk -d -o name,rota
```

坏道排查

```sh
# 1, 检查系统日志，关注messages中的 Medium Error
grep -i error /var/log/messages

/var/log/messages-20230813:Aug 11 16:46:02 mos02 kernel: sd 6:0:11:0: [sdl] tag#34 Sense Key : Medium Error [current] 
/var/log/messages-20230813:Aug 11 16:46:02 mos02 kernel: blk_update_request: critical medium error, dev sdl, sector 694333456

# 2, 硬盘信息查看，关注 Total uncorrected errors
smartctl -a /dev/sdl

Error counter log:
           Errors Corrected by           Total   Correction     Gigabytes    Total
               ECC          rereads/    errors   algorithm      processed    uncorrected
           fast | delayed   rewrites  corrected  invocations   [10^9 bytes]  errors
read:          0      147       149       147       2880    3403032.476           2
write:         0        0         0         0          0      30802.546           0
verify:        0        0         0         0          0         17.185           0


# 3, 阵列卡信息查看 perccli
rpm -ivh perccli-xxxx.rpm

/opt/MegaRAID/storcli/perccli/perccli64 /c0/eall/sall show all | grep 'Media Error Count'

...
Media Error Count = 0
Media Error Count = 1
Media Error Count = 0
...

/opt/MegaRAID/storcli/perccli/perccli64 /c0/e32/s11 show all

...
Drive /c0/e32/s11 State :
=======================
Shield Counter = 0
Media Error Count = 1
Other Error Count = 0
...

```

磁盘亮灯：

```sh
sgpio [-h] [-V] [[-d|--disk <device>[,<device>...]] | [-p|--port <port>[,<port>...]]] [-s|--status <status>] [-f|--freq <frequency>]

-h, --help
       displays a short help text
-V, --version
       displays the utility and AHCI SGPIO specification
-d, --disk
       disk name of LED location.  Names are sda,sdb,sdc,... Multiple names can be provided in a comma-delimited list.
-p, --port
       SATA port number of LED location, can be used if a disk name is no longer valid. 0,1,2,3,... Multiple ports can be provided in a comma-delimited list.
-s, --status
       status of the LED to set.  LED status is: locate, fault, rebuild, off
-f, --freq
       Set the frequency at which the LED should blink (in Hz). Frequency should be an integer between 1 and 10.

EXAMPLES
# Set the locate LED on SDA with an Intel Intelligent backplane:
sgpio -d sda -s locate

# Set the locate LED on SDA to flash at 3 Hz for non-intelligent backplanes:
sgpio -d sda -s locate -f 3

# Set SATA port 2 with fault at a 3 Hz flash rate:
sgpio -p 2 -s fault -f 3

# Set disks sda through sdf to fault:
sgpio -d sda,sdb,sdc,sdd,sde,sdf -s fault
```

* 查看虚拟机磁盘序列号

    > 默认情况下，VMware创建的虚拟机，无法查询到虚拟磁盘的序列号。如果是因为需要应用系统要求或者其他原因，需要系统内显示磁盘序列号，按以下步骤操作。

    * 1 关闭虚拟机
    * 2 编辑虚拟机vmx文件，添加以下内容：

        ```
        disk.EnableUUID="TRUE"
        ```

    * 3 重启即可查询。

        ```
        smartctl -a /dev/sda
        lsblk -d -n -o serial /dev/sda
        ```


## 内存

```sh
cat /proc/meminfo
free -m
dmidecode -t 5
```

## 网卡

```sh
ethtool ens33
ethtool -i ens33
```

## HBA

信息一般在 `/sys/class/fc_host/host*/` 目录下:

```sh
# WWN
~] cat /sys/class/fc_host/host2/port_name
0x5001438033114180
~] cat /sys/class/fc_host/host1/port_name
0x500143803311360c

# /sys/class/fc_host/host2/node_name
# /sys/class/fc_host/host2/fabric_name
```


## 主板及其他

`dmidecode -t` :

```sh
DMI TYPES
       The SMBIOS specification defines the following DMI types:

       Type   Information
       --------------------------------------------
          0   BIOS
          1   System
          2   Baseboard
          3   Chassis
          4   Processor
          5   Memory Controller
          6   Memory Module
          7   Cache
          8   Port Connector
          9   System Slots
         10   On Board Devices
         11   OEM Strings
         12   System Configuration Options
         13   BIOS Language
         14   Group Associations
         15   System Event Log
         16   Physical Memory Array
         17   Memory Device
         18   32-bit Memory Error
         19   Memory Array Mapped Address
         20   Memory Device Mapped Address
         21   Built-in Pointing Device
         22   Portable Battery
         23   System Reset
         24   Hardware Security
         25   System Power Controls
         26   Voltage Probe
         27   Cooling Device
         28   Temperature Probe
         29   Electrical Current Probe
         30   Out-of-band Remote Access
         31   Boot Integrity Services
         32   System Boot
         33   64-bit Memory Error
         34   Management Device
         35   Management Device Component
         36   Management Device Threshold Data
         37   Memory Channel
         38   IPMI Device
         39   Power Supply
         40   Additional Information
         41   Onboard Devices Extended Information
         42   Management Controller Host Interface

       Keyword     Types
       ------------------------------
       bios        0, 13
       system      1, 12, 15, 23, 32
       baseboard   2, 10, 41
       chassis     3
       processor   4
       memory      5, 6, 16, 17
       cache       7
       connector   8
       slot        9
```


## 附：磁盘接口（总线）类型

* `ATA`（Advanced Technology Attachment）

`ATA` 硬盘是传统的桌面级硬盘，通常也被称为`IDE` (Integrated Drive Electronics) 硬盘，这是一种 **并行总线硬盘**，转速为7200RPM。

![ATA](Pictures/ata.png)

* `SATA`（Serial ATA）

`SATA` 口的硬盘又叫 **串口硬盘**，从名称上我们就可以看出来这种类型的硬盘是ATA硬盘的升级版（可能 不太严谨）！这种硬盘采用点对点的连接方式，支持热插拔。转速为7200RPM，主要容量有750GB、1TB、2TB、4TB等。目前被广泛应用家用PC、某些服务器存储。 

![SATA](Pictures/sata.jpeg)

* `SCSI`（Small Computer System Interface）

`SCSI` 直译为 **小型计算机系统专用接口**。它是一种连接主机和外围设备的接口，支持包括硬盘、光驱及扫描仪在内的多种设备。`SCSI` 总线是一种 **并行总线**，常用于企业级存储领域。其优点是适应面广，性能高，硬盘转速快（15000RPM），缓存容量大，CPU占用率低，扩展性远优于IDE硬盘，并且 **支持热插拔**。缺点是价格昂贵，安装复杂。接口速率目前已经发展到320MB/s，基本已经达到极限。将来有被其串行版本SAS取而代之的趋势。

![SCSI](Pictures/scsi.png)

* `SAS`（Serial Attached SCSI） 

`SAS` 跟 `SATA` 硬盘有点类似，都是采用 **串行技术** 以获得更高的传输速度。`SAS` 是一种 **全双工、点对点、双端口** 的接口。主要用于高性能企业存储领域。这种类型的硬盘转速为15000RPM。

SAS 的接口技术可以 **向下兼容SATA** 。具体来说，二者的 **兼容性主要体现在物理层和协议层的兼容**。

在物理层，`SAS` 接口和 `SATA` 接口完全兼容，`SATA` 硬盘可以直接使用在 `SAS` 的环境中

从接口标准上而言，`SATA` 是 `SAS` 的一个子标准，因此 `SAS` 控制器可以直接操控 `SATA` 硬盘，但是 `SAS` 却不能直接使用在 `SATA` 的环境中，`SATA` 控制器并不能对 `SAS` 硬盘进行控制。


![SAS](Pictures/sas.jpeg)

* `FC`（Fiber Channel） 

`FC` 即为光纤通道技术，最早应用于SAN （存储局域网络）。FC接口是光纤对接的一种接口标准形式，其他的常见类型为：ST、SC、LC、MTRJ等。FC-AL支持全双工工作方式，其利用类似SATA/SAS所用的4芯连接，提供一种单环拓扑结构，一个控制器能访问126个设备。这是一种串行设备，转速高达15000RPM，常见容量为300GB。

![FC](Pictures/fc.jpeg)